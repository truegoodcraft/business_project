<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Core Dashboard</title>
    <link rel="stylesheet" href="/ui/static/styles.css" />
  </head>
  <body>
    <header class="page-header">
      <div class="header-main">
        <h1>Core Dashboard</h1>
        <button id="refresh-all" type="button">Refresh All</button>
      </div>
      <div class="token-controls">
        <label for="token-input">Session Token</label>
        <input type="password" id="token-input" autocomplete="off" />
        <button id="save-token" type="button">Save Token</button>
      </div>
    </header>

    <div class="banner info" id="local-banner">
      <strong>Local &amp; Transparent:</strong> data never leaves your machine. HTTP is
      localhost-only. Telemetry is off.
    </div>

    <div class="banner error hidden" id="token-banner">Invalid or missing token</div>

    <nav class="tab-bar">
      <button id="tab-btn-dashboard" class="tab-button active" type="button">Dashboard</button>
      <button id="tab-btn-settings" class="tab-button" type="button">Settings</button>
    </nav>

    <section id="tab-dashboard" class="tab-section">
      <main class="panels">
        <section class="panel" data-panel="health">
          <div class="panel-header">
            <h2>Health</h2>
            <div class="panel-actions">
              <span class="panel-meta" data-role="timing">&mdash;</span>
              <span class="panel-meta" data-role="timestamp">&mdash;</span>
              <button type="button" data-action="refresh">Refresh</button>
            </div>
          </div>
          <div id="google-auth-row" class="row">
            <span class="label">Google Drive</span>
            <span id="google-status" class="status-pill bad">Missing info</span>
            <button
              id="google-disconnect"
              class="btn btn-danger"
              type="button"
              style="display: none;"
            >
              ✕ Disconnect
            </button>
            <span id="google-check" class="check" style="display: none;">✓ Connected</span>
          </div>
          <pre class="panel-content" data-role="content"></pre>
          <div class="panel-error" data-role="error"></div>
        </section>

        <section class="panel" data-panel="plugins">
          <div class="panel-header">
            <h2>Plugins</h2>
            <div class="panel-actions">
              <span class="panel-meta" data-role="timing">&mdash;</span>
              <span class="panel-meta" data-role="timestamp">&mdash;</span>
              <button type="button" data-action="refresh">Refresh</button>
            </div>
          </div>
          <pre class="panel-content" data-role="content"></pre>
          <div class="panel-error" data-role="error"></div>
        </section>

        <section class="panel" data-panel="capabilities">
          <div class="panel-header">
            <h2>Capabilities</h2>
            <div class="panel-actions">
              <span class="panel-meta" data-role="timing">&mdash;</span>
              <span class="panel-meta" data-role="timestamp">&mdash;</span>
              <button type="button" data-action="refresh">Refresh</button>
            </div>
          </div>
          <pre class="panel-content" data-role="content"></pre>
          <div class="panel-error" data-role="error"></div>
        </section>

        <section class="panel" data-panel="probe">
          <div class="panel-header">
            <h2>Probe</h2>
            <div class="panel-actions">
              <span class="panel-meta" data-role="timing">&mdash;</span>
              <span class="panel-meta" data-role="timestamp">&mdash;</span>
              <button type="button" data-action="refresh">Run Probe</button>
            </div>
          </div>
          <div class="probe-controls">
            <label for="probe-services">Services (JSON array)</label>
            <textarea id="probe-services" rows="3">["echo"]</textarea>
            <button id="run-probe" type="button">Run Probe</button>
          </div>
          <pre class="panel-content" data-role="content"></pre>
          <div class="panel-error" data-role="error"></div>
        </section>

        <section class="panel outputs-panel">
          <div class="panel-header">
            <h2>Outputs</h2>
            <div class="panel-actions">
              <button id="outputs-refresh" type="button">Refresh</button>
            </div>
          </div>
          <div class="outputs-controls">
            <div style="margin:8px 0;">
              <div id="reader-status" class="muted" style="margin-bottom:6px;">Checking sources…</div>
              <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
                <label>Source:</label>
                <select id="reader-source">
                  <option value="drive">Drive</option>
                  <option value="local">Local</option>
                </select>
                <button id="reader-fullpull" class="btn">Start Full Pull</button>
                <button id="reader-cancelpull" class="btn btn-secondary" disabled>Cancel</button>
                <span id="reader-progress" class="muted"></span>
              </div>
            </div>
            <button id="reader-index-all" type="button" class="btn">Index All</button>
          </div>
          <div id="reader-tree" class="tree"></div>
        </section>
      </main>

      <section class="panel logs" data-panel="logs">
        <div class="panel-header">
          <h2>Logs</h2>
          <div class="panel-actions">
            <span class="panel-meta" data-role="timing">&mdash;</span>
            <span class="panel-meta" data-role="timestamp">&mdash;</span>
            <label class="autoscale">
              <input type="checkbox" id="logs-autoscroll" /> Auto-scroll
            </label>
            <button type="button" data-action="refresh">Refresh</button>
          </div>
        </div>
        <pre class="panel-content" data-role="content" id="logs-content"></pre>
        <div class="panel-error" data-role="error"></div>
      </section>
    </section>

    <section id="tab-settings" class="tab-section" style="display: none;">
      <div class="panels settings-panels">
        <section class="panel settings-card">
          <div class="settings-card-header">
            <div>
              <h2>Integrations</h2>
              <p class="settings-subtitle">Google Drive (Read-only)</p>
            </div>
            <span id="gs-status" class="status-pill bad">Not configured</span>
          </div>
          <div class="form-field">
            <label for="gs-client-id">Client ID</label>
            <input id="gs-client-id" type="text" autocomplete="off" />
            <small class="field-note">Shown masked on load; leave blank to keep existing.</small>
          </div>
          <div class="form-field">
            <label for="gs-client-secret">Client Secret</label>
            <input id="gs-client-secret" type="password" autocomplete="off" />
            <small class="field-note">Shown masked on load; leave blank to keep existing.</small>
          </div>
          <div class="settings-actions">
            <button id="gs-save" class="btn" type="button">Save</button>
            <button id="gs-test" class="btn" type="button">Test Connection</button>
            <button id="gs-remove" class="btn btn-danger" type="button">Remove / Disconnect</button>
          </div>
        </section>
      </div>
    </section>

    <script src="/ui/static/app.js" defer></script>
  </body>
</html>
